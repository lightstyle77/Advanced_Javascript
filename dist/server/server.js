!function (e) { var t = {}; function n(r) { if (t[r]) return t[r].exports; var o = t[r] = { i: r, l: !1, exports: {} }; return e[r].call(o.exports, o, o.exports, n), o.l = !0, o.exports } n.m = e, n.c = t, n.d = function (e, t, r) { n.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: r }) }, n.r = function (e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, n.t = function (e, t) { if (1 & t && (e = n(e)), 8 & t) return e; if (4 & t && "object" == typeof e && e && e.__esModule) return e; var r = Object.create(null); if (n.r(r), Object.defineProperty(r, "default", { enumerable: !0, value: e }), 2 & t && "string" != typeof e) for (var o in e) n.d(r, o, function (t) { return e[t] }.bind(null, o)); return r }, n.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return n.d(t, "a", t), t }, n.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, n.p = "/", n(n.s = 2) }([function (e, t) { e.exports = require("fs") }, function (e, t) { e.exports = require("express") }, function (e, t, n) { var r = n(1), o = n(0), i = r(), u = n(3); i.use(r.json()), i.use("/", r.static("dist/public")), i.use("/api/cart", u), i.get("/api/products", function (e, t) { o.readFile("dist/server/db/products.json", "utf-8", function (e, n) { e ? t.sendStatus(404, JSON.stringify({ result: 0, text: e })) : t.send(n) }) }); var s = process.env.PORT || 3e3; i.listen(s, function () { return console.log("Listen on port ".concat(s, "...")) }) }, function (e, t, n) { var r = n(1), o = n(0), i = r.Router(), u = n(4); i.get("/", function (e, t) { o.readFile("dist/server/db/userCart.json", "utf-8", function (e, n) { e ? t.sendStatus(404, JSON.stringify({ result: 0, text: e })) : t.send(n) }) }), i.post("/", function (e, t) { u(e, t, "add", "dist/server/db/userCart.json") }), i.put("/:id", function (e, t) { u(e, t, "change", "dist/server/db/userCart.json") }), i.delete("/:id", function (e, t) { u(e, t, "remove", "dist/server/db/userCart.json") }), e.exports = i }, function (e, t, n) { var r = n(5), o = n(0), i = n(6), u = { add: r.add, change: r.change, remove: r.remove }; e.exports = function (e, t, n, r) { o.readFile(r, "utf-8", function (s, a) { if (s) t.sendStatus(404, JSON.stringify({ result: 0, text: s })); else { var c = u[n](JSON.parse(a), e), f = c.newCart, d = c.name; o.writeFile(r, f, function (e) { e ? t.sendStatus(404, JSON.stringify({ result: 0, text: e })) : (i(d, n), t.send(JSON.stringify({ result: 1 }))) }) } }) } }, function (e, t) { e.exports = { add: function (e, t) { return e.contents.push(t.body), { newCart: JSON.stringify(e, null, 4), name: t.body.product_name } }, change: function (e, t) { var n = e.contents.find(function (e) { return e.id_product === +t.params.id }); return n.quantity += t.body.quantity, { newCart: JSON.stringify(e, null, 4), name: n.product_name } }, remove: function (e, t) { var n = e.contents.find(function (e) { return e.id_product === +t.params.id }); return e.contents.splice(e.contents.indexOf(n), 1), { newCart: JSON.stringify(e, null, 4), name: n.product_name } } } }, function (e, t, n) { var r = n(7), o = n(0); e.exports = function (e, t) { o.readFile("dist/server/db/stats.json", "utf-8", function (n, i) { if (n) console.log("Can`t read file"); else { var u = JSON.parse(i); r.locale("ru"), u.push({ action: t, prod_name: e, time: r().format("DD MMM YYYY, H:mm:ss") }), o.writeFile("dist/server/db/stats.json", JSON.stringify(u, null, 4), function (e) { e && console.log("Can`t write file") }) } }) } }, function (e, t) { e.exports = require("moment") }]);